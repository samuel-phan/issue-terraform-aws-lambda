# issue-terraform-aws-lambda

This repository is to test the issue <https://github.com/terraform-aws-modules/terraform-aws-lambda/issues/396>. 

# Test scenario

The test scenario is implemented in the [`scripts/test.sh`](scripts/test.sh).

The goal is to simulate what would detect the CICD environment that will start `terraform` in an empty environment,
typically without the `builds` directory (and the archives/packages), generated by the lambda module.

# Test the `upstream` lambda module

1. Get some AWS credentials.
2. Run:

    ```shell
    scripts/test.sh upstream
    ```

   You should see an error because `terraform plan` detects a diff after removing the `builds` directory.

3. Teardown:

    ```shell
    terraform -chdir=upstream destroy
    ```

# Test the `fixed` lambda module

1. Get some AWS credentials.
2. Run:

    ```shell
    scripts/test.sh fixed
    ```

   You should see no error.

3. Teardown:

    ```shell
    terraform -chdir=fixed destroy
    ```
